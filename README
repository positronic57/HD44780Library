Short Description

HD44780library is C library for LCD with HD44780 display controller for AVR 8-bit microcontrollers.
The library implements 4-bit data bus for communication with the HD44780 LCD controller. 
The communication is done in one direction only, from the microcontroller towards HD44780.
The library can only write data to HD44780. The value of R/W pin is all the time set to 0 by the library. 
Busy Flag checks are replaced by time delay functions.


Supported MCU Hardware

The library is compatible with every 8-bit AVR microcontroller.

Supported sizes of LCD modules based on HD44780:
- 16x2   
- 16x4
The other sizes should also be supported but they are not tested yet.

Implemented HD44780 functionalists:
- send characters via 4bit data bus;
- send a string;
- send HD44780 commands;
- define custom special characters.

Library Description

HD44780 is represented by a structure defined as:

typedef struct SHD44780
{
	volatile uint8_t *HD44780_CMD_PORT;	//AVR Port used for the command bus of HD44780 LCD driver
	volatile uint8_t *HD44780_DATA_PORT;	//AVR Port used for the data bus of HD44780 LCD driver
	uint8_t HD44780_RS;			//Defines the RS control pin from the CMD_PORT
	uint8_t HD44780_E;			//Defines the E control pin from the CMD_PORT
	uint8_t HD44780_RW;			//Define the R/W control pin from the CMD_PORT
} TSHD44780;


The following functions are included in the library:

 - void LCDInit4(TSHD44780 *pHD44780,volatile uint8_t *HD44780_CMD_PORT,volatile uint8_t *HD44780_DATA_PORT,uint8_t HD44780_RS,uint8_t HD44780_E,uint8_t HD44780_RW,uint8_t lineNumbers);
	The function is used to assign AVR ports/pins to the HD44780 bus and initilaze the HD44780 driver.

 - void LCDSendCommand4(TSHD44780 *pHD44780,uint8_t Command2Send);
	Send a command to HD44780;

 - void LCDShowCharacter4(TSHD44780 *pHD44780,char Character2Show);
	Send a character to HD44780;

 - void LCDShowString4(TSHD44780 *pHD44780,char *String2Show);
	Send a string to HD44780;

 - void LCDDefineSpecialChars4(TSHD44780 *pHD44780,uint8_t (*charMatrix)[8],uint8_t numberOfSpecChars);
	Define custom special characters.
 
Macros:
   LCDSetCursorPosition4(LCD,lineBaseAddress,position);
	Move the cursor in the line with base address<lineBaseAddress> at position<position>. 


Usage

Operating HD44780 LCD controller in 4-bit data bus requires 7 PINs from the microcontroller:
- 4 data pins;
- 3 command/control PINs: E, RS and R/W. R/W pin of the LCD is constantly set at logical 0 
  that puts HD44780 in write mode. The library will not read data out of the HD44780.

Both ports must be specified in the init function. For the PORT that will be selected for the DATA bus,
the library assumes that the lower nibble from the PORT is reserved for communication with HD44780
and the higher nibble can be used for other purposes.

For example:

LCDInit4(pHD44780Display,&PORTD,&PORTB,PD4,PD7,PD6,TWO_LINE_DISPLAY);

defines PORTD as command port with PD4, PD7 and PD6 as control pins; 
PORTB as data port where PD0-3 will be used by the library.
Those data PINs must be attached to the data pins of HD44780 as described in the data sheet.

A list of predefined HD44780 commands can be found in the header file.

Defining custom special characters

HD44780 supports up to 8 user defined characters. The definitions of the characters are stored in the CGRAM of the controller.
CGRAM is 64 bytes long where each character is defined by 8 bytes.
The library expects the characters definitions to be stored in matrix with 8 columnes and up to 8 rows. 
One column of the matrix should contain the definition of one character.


See example section of the library for further details how to use the library in practice.


WARNING: 
The source is provided as it is without any warranty. Use it on your own risk!
The author does not take any responsibility for the damage caused while using this software.

Tested on Atmel Atmega32 microcontroller with JHD 162A 16x2 LCD module.
